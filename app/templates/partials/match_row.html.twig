{# templates/partials/match_row.html.twig #}
{# Normalize enum|string -> string for status #}
{% set _statusObj = m.status ?? null %}
{% set status = _statusObj is same as(null)
    ? 'scheduled'
    : (attribute(_statusObj, 'value') is defined ? attribute(_statusObj,'value') : _statusObj) %}

{# date/time pieces #}
{% set timeStr = m.dateUtc|date('H:i') %}
{% set dateStr = m.dateUtc|date('D d M') %} {# e.g., Sat 21 Sep #}

{% set minute   = m.minute ?? null %}
{% set isLive   = status == 'live' %}
{% set showHome = m.homeScore is not null %}
{% set showAway = m.awayScore is not null %}
{% set statusLabel = isLive and minute ? minute ~ "'" : status %}

<div class="row match-row">
  <div class="cell-when">
    <span class="when">
      <span class="time">{{ timeStr }}</span>
      <span class="date d-desktop">{{ dateStr }}</span>
    </span>
    <span class="status-pill {{ status }}">{{ statusLabel }}</span>
  </div>

  <div class="match-center">
    <a class="team team-home ellipsis team-link" href="{{ path('team_show', {slug: m.homeTeam.slug}) }}">
      <img src="{{ m.homeTeam.logo ?? '' }}" alt="" loading="lazy" decoding="async">
      <span class="ellipsis">{{ m.homeTeam.name }}</span>
    </a>

    <a class="score score-link" href="{{ path('match_show', {id: m.id}) }}">
      {% if showHome or showAway %}
        <strong>{{ showHome ? m.homeScore : ' ' }}</strong><span class="dash">-</span><strong>{{ showAway ? m.awayScore : ' ' }}</strong>
      {% else %}
        <span class="vs">vs</span>
      {% endif %}
    </a>

    <a class="team team-away ellipsis team-link" href="{{ path('team_show', {slug: m.awayTeam.slug}) }}">
      <span class="ellipsis">{{ m.awayTeam.name }}</span>
      <img src="{{ m.awayTeam.logo ?? '' }}" alt="" loading="lazy" decoding="async">
    </a>
  </div>
</div>


<style>
.match-row{
  display:grid;
  grid-template-columns: minmax(120px,160px) 1fr 72px 1fr;
  gap:10px; align-items:center; padding:10px; border-radius:10px;
  transition:background .15s ease;
}
.match-row:hover{ background:#0f172a }

.match-row .cell-when{ display:flex; align-items:center; gap:8px; min-width:0 }
.when .time{ font-variant-numeric:tabular-nums; }
.when .date{ opacity:.8; margin-left:8px; }  /* shown on desktop */
.status-pill{
  display:inline-flex; align-items:center; justify-content:center;
  height:22px; padding:0 8px; border-radius:999px; font-size:12px; line-height:1;
  border:1px solid #374151; text-transform:capitalize;
}
.status-pill.live{ color:#fca5a5; border-color:#fca5a5 }
.status-pill.scheduled{ color:#a7f3d0; border-color:#a7f3d0 }
.status-pill.finished{ color:#93c5fd; border-color:#93c5fd }

.match-row .team{ display:flex; gap:8px; align-items:center; min-width:0; color:inherit; text-decoration:none }
.match-row .team img{ width:22px; height:22px; object-fit:contain; border-radius:4px; background:#0b0f14 }
.match-row .team-away{ justify-self:end }
.match-row .team-link:hover{ text-decoration:underline }

.match-row .score{ text-align:center; color:inherit; text-decoration:none; white-space:nowrap }
.match-row .score strong{ font-weight:700; font-variant-numeric:tabular-nums }
.match-row .dash{ opacity:.8; margin:0 2px }
.match-row .vs{ opacity:.7 }

/* responsive */
@media (max-width: 820px){
  .match-row{ grid-template-columns: 110px 1fr 60px 1fr; }
}
@media (max-width: 600px){
  .match-row{ grid-template-columns: 1fr 1fr; grid-auto-rows:auto }
  .match-row .cell-when{ grid-column:1 / 2 }
  .match-row .score{ grid-column:2 / 3; justify-self:end }
  .match-row .team-home{ grid-column:1 / 3 }
  .match-row .team-away{ grid-column:1 / 3; justify-self:stretch }
  .match-row .team img{ width:20px; height:20px }
  .when .date{ display:none } /* hide date on small screens; time stays */
}
@media (max-width: 420px){
  .match-row{ padding:8px }
  .status-pill{ height:20px; padding:0 6px; font-size:11px }
}
@media (min-width: 768px) {
  .match-row {
    flex-direction: row;
  }

  .cell-when {
    flex: 0 0 auto;
    margin-right: 20px;
    text-align: left;
  }

  .match-center {
    flex: 1;
    justify-content: flex-start;
  }
}

@media (max-width: 767px) {
  .match-row {
    flex-direction: column;
  }

  .cell-when,
  .match-center {
    flex: 1 1 100%;
    text-align: center;
    justify-content: center;
  }
}

.match-row {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

/* Desktop version: align on the same row */
@media (min-width: 768px) {
  .match-row {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }

  .cell-when {
    text-align: left;
  }

  .match-center {
    display: flex;
    gap: 10px;
    align-items: center;
  }
}

/* Mobile version: column and center */
@media (max-width: 767px) {
  .cell-when, .match-center {
    text-align: center;
  }

  .match-center {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
}


</style>
